Baseball Diary – 작업 컨벤션(AGENTS.md)

적용 범위

- 리포지토리 전체에 적용됩니다(루트 스코프).
- 더 깊은 경로에 위치한 AGENTS.md는 해당 하위 트리에 대해 이 규칙을 덮어쓸 수 있습니다.

핵심 원칙

- 작은 단위의 집중된 변경만 수행하고, 관련 없는 파일은 건드리지 않습니다.
- 가독성과 안전성을 우선시합니다.
- 명시되지 않은 한, 기존 동작과의 호환성을 유지합니다.

언어/런타임

- 앱 코드는 Next.js + React + TypeScript를 사용합니다.
- Node LTS, ES Module 설정을 따릅니다.

TypeScript 규칙

- any는 절대 사용하지 않습니다.
  - 타입을 모를 경우 `unknown`을 사용하고, 사용 지점에서 정제(narrow)합니다.
  - 발생해서는 안 되는 상태는 `never`를 사용합니다.
  - 넓은 타입보다 제네릭/식별 가능한 유니온 등 정확한 타입을 우선합니다.
- strict 모드를 유지하며 컴파일러 옵션을 느슨하게 만들지 않습니다.
- `as any`나 불필요한 non-null 단언(`!`)은 금지합니다. 필요한 경우 런타임 가드를 추가합니다.

React 패턴

- 함수형 컴포넌트만 사용합니다(클래스 컴포넌트 금지).
- 단순 컴포넌트는 사용처 근처에 배치하고, 공유 컴포넌트는 `components/atoms|molecules|organisms|templates|pages`에 둡니다.
- Props는 명시적으로 타이핑합니다. 과도한 프롭 드릴링 대신 컴포지션을 고려합니다.
- 폼은 가능하면 controlled input으로 구성하고, 상태는 최소화합니다.

스타일링

- Tailwind 유틸리티만 사용합니다(CSS-in-JS 금지).
- 유틸리티 클래스는 레이아웃 → 간격 → 타이포그래피 → 색상 → 효과 순으로 논리적으로 정렬합니다.
- 기존 반응형 브레이크포인트를 존중하고, 모바일/데스크톱 모두 확인합니다.

접근성(a11y)

- 모든 인터랙티브 요소는 키보드 포커스 가능해야 하며 적절한 라벨을 가집니다.
- 시맨틱 태그(`button`, `label`, `nav` 등)를 우선 사용합니다.
- 이미지에는 대체 텍스트를 제공하고, `aria-*`는 필요한 경우에만 사용합니다.

임포트/네이밍

- 가능하면 `@/` 절대 경로 임포트를 사용합니다. 순서는 표준 → 외부 → 내부 모듈 순으로 유지합니다.
- 컴포넌트/타입은 PascalCase, 훅은 `use*` 접두사를 사용합니다.
- 상수형 변수(런타임 동안 변하지 않는 의미상의 상수)는 대문자 SNAKE_CASE를 사용합니다. 예) `MAX_RETRY_COUNT`, `API_BASE_URL`.
- 변수명은 축약하지 말고 의미를 드러내는 전체 단어를 사용합니다.
  - 예외: 매우 국소적인 루프 인덱스(`i`, `j`) 또는 수학적 좌표(`x`, `y`) 등 관례적인 기호는 허용합니다.

경로 상수(Path) 컨벤션
- 모든 라우트 경로/이름은 `src/constants/path.ts`에 정의합니다.
- 형태: `export const PATHS = { HOME: { path: '/', name: '홈' }, ... } as const;`
- 내비게이션/링크/헤더 등에서 하드코딩된 문자열 대신 `PATHS.*.path`/`PATHS.*.name`을 사용합니다.
- 공용 내비용 배열이 필요하면 `NAV_ITEMS`처럼 `PATHS` 기반으로 생성하여 재사용합니다.

프로젝트 구조

- 요청되지 않은 폴더 재구성은 하지 않습니다.
- 공통 유틸은 `lib/`, 공용 타입은 `types.ts` 또는 `types/*`에 둡니다.

테스트/검증

- 기존 테스트 체계가 있는 경우 가벼운 단위 테스트를 선호합니다. 새 프레임워크 도입은 지양합니다.
- 동작 변경 시 기존 패턴에 맞춰 테스트를 추가/수정합니다.

성능

- 불필요한 리렌더를 피하고, 명확한 이득이 있을 때만 메모이제이션합니다.
- 번들 크기를 고려해 불필요한 의존성 추가를 피합니다.

문서화

- 공개 API/명령/가시적 동작이 바뀌면 README 또는 문서를 갱신합니다.
- 주석은 최소화하고, 자체 설명적인 코드/이름을 지향합니다.
- 코드 주석은 기본적으로 한글로 작성합니다. 외부 공개 API 스펙이나 제3자 라이브러리 인용 등 영문이 적합한 경우에만 영문을 병기합니다.

Git 운영

- 사용자가 요청하지 않는 한 커밋하지 않습니다.
- 패치는 목적에 집중하고, 변경 이유를 명확히 설명합니다.

사용 방법

- 이 파일은 에이전트가 이 레포에서 작업할 때 따라야 할 규칙을 정의합니다.
- 상세한 문서는 `docs/` 하위에 추가로 작성하고, 여기에서 링크로 안내할 수 있습니다.

리액트/Next 정책 준수
- 서버/클라이언트 경계를 존중합니다. 브라우저 전역(window/document/navigator 등)에 직접 접근하지 않습니다.
  - 필요한 경우 클라이언트 전용 훅으로 캡슐화하고, SSR 가드(`typeof window !== 'undefined'`)를 반드시 추가합니다.
- Script 태그 인라인 사용을 지양합니다. 기능은 훅/컴포넌트로 추출하고, 정말 필요한 경우에만 `next/script`를 사용합니다.
- 이벤트 리스너/타이머 등도 훅(`useEffect`, `useInterval` 유틸 등)로 관리하여 정리(cleanup)를 보장합니다.

폴더 구조(페이지/로직 분리)
- App Router의 페이지는 UI 조립을 `components/pages/*/index.tsx`에 위임합니다.
  - 예) `/record` → `src/components/pages/record/index.tsx`
  - 동적 경로는 `components/pages/<route>/...` 하위에 세부 폴더를 둡니다. 예) `/entries/[id]` 상세 → `components/pages/entries/detail/index.tsx`, 수정 → `components/pages/entries/edit/index.tsx`
- 각 페이지의 클라이언트 로직/데이터 훅은 `components/pages/<route>/common/use*.tsx`에 둡니다.
  - 예) `useRecord`, `useHome`, `useEntries`, `useStats`, `useSettings`
- `app/<route>/page.tsx`는 해당 View 컴포넌트만 불러와 렌더합니다(서버 컴포넌트).
- 경로 상수/빌더는 `src/constants/path.ts`에 정의합니다. 예) `PATHS`, `buildEntryPath`, `buildEntryEditPath`.

훅/컴포넌트 작성 규칙(간결한 반환)
- 반환 객체/JSX 안에서는 인라인 로직을 최소화합니다.
- 계산 로직/헬퍼 함수는 `return` 위에서 `const fn = () => ...` 형태로 정의하고, `return { fn }`처럼 참조만 반환합니다.
- 목적: 가독성, 참조 안정성(불필요한 새 함수 생성 방지), 테스트 용이성 확보.
